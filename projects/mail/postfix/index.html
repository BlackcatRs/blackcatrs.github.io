<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>About SMTP Server — Postfix | Vithurshan SELVARAJAH</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/fonts/css/all.min.css><link rel=stylesheet href=/css/header-num.css><link rel=stylesheet href=/css/fonts.css></head><body><nav><ul class=menu><li><a href=/>Home</a></li><li><a href=/notes/>Notebook</a></li><li><a href=/categories/>Categories</a></li><li><a href=/projects/>Projects</a></li><li><a href=/index.xml>RSS</a></li></ul><hr></nav><div class=article-meta><h1><span class=title>About SMTP Server — Postfix</span></h1><div class=post-meta><span> Published on 19 Feb 2025</span>
<span class=seperator>.</span>
<span> Filed in <a href=/projects>Projects</a></span>
<span class=seperator>.</span>
<span> 562 words</span></div></div><main><div id=outline-container-headline-1 class=outline-2><h2 id=headline-1>Introduction</h2><div id=outline-text-headline-1 class=outline-text-2><p>The Postfix software is responsible for transferring or receiving mails from other SMTP server using SMTP protocol. It uses a concept called address class to group recipients based on their mail delivery method and only accept mail from domains in the address class. There are three types of address classes:</p><ol><li>Canonical domains (also called local domains)</li><li>Hosted domains (Virtual mailbox domains + Virtual alias domains)</li><li>Relay domains</li></ol><p>And finally there are two mandatory email addresses for every domain that you host. <code class=verbatim>postmaster@domain</code> and <code class=verbatim>abuse@domain</code>. These requirements are documented in RFC 521 and RFC 2142. Be sure to add aliases for them. If an email to those addresses will bounce your domain reputation will suffer.</p></div></div><div id=outline-container-headline-2 class=outline-2><h2 id=headline-2>Canonical domains</h2><div id=outline-text-headline-2 class=outline-text-2><p>In most cases, the Postfix systems are the final destination for only a few domain names. These domain names are the host name and/or IP address of the machine that Postfix running on. These domains are called canonical domains.</p><p>Mails to canonical domains are delivered using a Unix-like mail delivery method. It only accepts mail from/to valid user accounts, or in other words, it checks the username in the <code class=verbatim>/etc/passwd</code> file and then stores the mail in the <code class=verbatim>/var/mail/username</code> directory.</p><p>The disadvantage of this address class is that we cannot have a Postfix server responsible for two domains and two mail directories if the recipient's email address is the same. If Postfix receives emails for recipients <code class=verbatim>user1@example1.com</code> and <code class=verbatim>user1@example2.com</code>, it will store both emails in the mail directory <code class=verbatim>/var/mail/user1</code> because of Unix-like mail delivery method.</p></div></div><div id=outline-container-headline-3 class=outline-2><h2 id=headline-3>Hosted domains</h2><div id=outline-text-headline-3 class=outline-text-2><p>Besides the canonical domains, Postfix can be configured to be the final destination for any number of additional domains. These domains are called hosted domains because they are not directly associated with the host name of the machine that Postfix running on.</p><p>We can use a text file, database or LDAP to specify the domains that Postfix is ​​responsible for, the email address and the mail directory of the recipient on disk to store the emails.</p><p>Postfix expects this data in the form of a mapping. The mapping is a two-column table, the left column is considered the key and the right column is considered the value. Here is an example mapping that shows valid email addresses and the path to the mail directory on disk:</p><table><thead><tr><th>Virtual mailbox (key)</th><th>Virtual mailbox location on disk (value)</th></tr></thead><tbody><tr><td>user1@example1.com</td><td>/var/vmail/example1.com/user1/Maildir</td></tr><tr><td>user2@example1.com</td><td>/var/vmail/example1.com/user2/Maildir</td></tr><tr><td>user1@example2.com</td><td>/var/vmail/example2.com/user1/Maildir</td></tr></tbody></table><p>Before checking if a specific email address is valid, Postfix first checks if it is responsible for the domain. This is done by the following mapping:</p><table><thead><tr><th>Virtual domain</th><th>Whatever</th></tr></thead><tbody><tr><td>example1.com</td><td>xxxx</td></tr><tr><td>example2.com</td><td>yyyy</td></tr></tbody></table><p>Note the second column which contains a random string because Postfix expects the data to be in form of mapping, but it will not use the second column data when checking for a valid domain.</p><p>These all you need to get a functional mail server. However Postfix provides another useful feature called aliases. An alias is a redirection (or forwarding) of one email address to one or more other addresses.</p><table><tbody><tr><td>Virtual email address</td><td>Redirect to</td></tr><tr><td>postmaster@example.org</td><td>user1@example1.com</td></tr><tr><td>jack@example.com</td><td>user1@example1.com,user1y@example2.com</td></tr></tbody></table><ol><li>Redirect emails for postmaster@example.org to <code class=verbatim>user1@example.org</code>.</li><li>Keep a copy of an incoming email for <code class=verbatim>user1@example.com</code> in his mailbox and send another copy to <code class=verbatim>user@example2.com</code>. You can use multiple email addresses seperated by commas.</li></ol></div></div><div id=outline-container-headline-4 class=outline-2><h2 id=headline-4>Relay domains</h2><div id=outline-text-headline-4 class=outline-text-2><p>Relay domains are domains for which the Postfix does not handle delivery but forwards it to another specified SMTP server.</p></div></div></main><footer><hr>© <a href=https:www.atomicl.net>Vithurshan SELVARAJAH</a> 2022 – 2025 | <a href=https://github.com/BlackcatRs>Github</a> | <a href=https://www.linkedin.com/in/vithurshan-selvarajah/>LinkedIn</a></footer></body></html>